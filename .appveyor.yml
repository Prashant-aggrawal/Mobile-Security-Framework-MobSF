environment:
  matrix:
    - PYTHON: "C:\\Python36-x64"
cache:
  - "%APPDATA%\\pip"
install:
  - cmd: SET JAVA_HOME="C:\Program Files\Java\jdk9"
  - cmd: SET PATH=%JAVA_HOME%\bin;%PATH%
  - cmd: java -version
  # We need wheel installed to build wheels
  - "%PYTHON%\\python.exe -m pip install -U wheel tox pip setuptools"
  - '%PYTHON%\\python.exe -m pip wheel --wheel-dir=yara-python --build-option="build" --build-option="--enable-dex" git+https://github.com/VirusTotal/yara-python.git'
  - "%PYTHON%\\python.exe -m pip install --no-index --find-links=yara-python yara-python"
  - "%PYTHON%\\python.exe -m pip install -r requirements.txt"
  - "%PYTHON%\\python.exe manage.py makemigrations"
  - "%PYTHON%\\python.exe manage.py migrate"
build: off
test_script:
  - appveyor-retry %PYTHON%\\python.exe manage.py test
